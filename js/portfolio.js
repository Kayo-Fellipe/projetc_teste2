// Portfolio Data - Define all projects and their galleries
const portfolioData = {
  sessao_lays_nicolas: {
    title: "Sess達o Lays & Nicolas",
    type: "photography",
    date: "2024-12-15",
    category: "Ensaios",
    items: [
      {
        type: "image",
        src: "https://i.postimg.cc/TYYBJD06/DSC-0234-Original.jpg",
        thumbnail: "https://i.postimg.cc/TYYBJD06/DSC-0234-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/qqZwLzBJ/DSC01255-Original.jpg",
        thumbnail: "https://i.postimg.cc/qqZwLzBJ/DSC01255-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/MTmry6jH/DSC01251-Original.jpg",
        thumbnail: "https://i.postimg.cc/MTmry6jH/DSC01251-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/mrNSndZ6/IMG-5779.jpg",
        thumbnail: "https://i.postimg.cc/mrNSndZ6/IMG-5779.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/tCvR3yhB/DSC-0130-Original.jpg",
        thumbnail: "https://i.postimg.cc/tCvR3yhB/DSC-0130-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/MKpKfXjc/DSC-0222-Original.jpg",
        thumbnail: "https://i.postimg.cc/MKpKfXjc/DSC-0222-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/dQ8Tj714/DSC01249-Original.jpg",
        thumbnail: "https://i.postimg.cc/dQ8Tj714/DSC01249-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/BbcLSzyd/DSC-0131-Original.jpg",
        thumbnail: "https://i.postimg.cc/BbcLSzyd/DSC-0131-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/6qN4NKHr/DSC01182-Original.jpg",
        thumbnail: "https://i.postimg.cc/6qN4NKHr/DSC01182-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/g2wz45sm/DSC-0029-Original.jpg",
        thumbnail: "https://i.postimg.cc/g2wz45sm/DSC-0029-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/Ls1s47gN/DSC-0051-Original.jpg",
        thumbnail: "https://i.postimg.cc/Ls1s47gN/DSC-0051-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/52G0V1yX/DSC-0037-Original.jpg",
        thumbnail: "https://i.postimg.cc/52G0V1yX/DSC-0037-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/NMvjK41Y/DSC-0116-Original.jpg",
        thumbnail: "https://i.postimg.cc/NMvjK41Y/DSC-0116-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/7YKhKSyM/DSC-0083-Original.jpg",
        thumbnail: "https://i.postimg.cc/7YKhKSyM/DSC-0083-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/SxwyPr18/DSC01203-Original.jpg",
        thumbnail: "https://i.postimg.cc/SxwyPr18/DSC01203-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/Y23CSQjK/DSC01208-Original.jpg",
        thumbnail: "https://i.postimg.cc/Y23CSQjK/DSC01208-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/zv0zPY4X/DSC01211-Original.jpg",
        thumbnail: "https://i.postimg.cc/zv0zPY4X/DSC01211-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/L5H4T8Cb/DSC01212-Original.jpg",
        thumbnail: "https://i.postimg.cc/L5H4T8Cb/DSC01212-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/1XTTzWqr/DSC-0185-Original.jpg",
        thumbnail: "https://i.postimg.cc/1XTTzWqr/DSC-0185-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/hvHynfkC/DSC01205-Original.jpg",
        thumbnail: "https://i.postimg.cc/hvHynfkC/DSC01205-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/Y9CyzcNx/DSC-0179-Original.jpg",
        thumbnail: "https://i.postimg.cc/Y9CyzcNx/DSC-0179-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/wv44WW0Y/DSC01241-Original.jpg",
        thumbnail: "https://i.postimg.cc/wv44WW0Y/DSC01241-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/fRMFR03F/DSC-0199-Original.jpg",
        thumbnail: "https://i.postimg.cc/fRMFR03F/DSC-0199-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/3JXVhZwm/DSC-0239-Original.jpg",
        thumbnail: "https://i.postimg.cc/3JXVhZwm/DSC-0239-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/15h2bdyy/DSC-0256-Original.jpg",
        thumbnail: "https://i.postimg.cc/15h2bdyy/DSC-0256-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/8CtZ5K8f/IMG-5827.jpg",
        thumbnail: "https://i.postimg.cc/8CtZ5K8f/IMG-5827.jpg"
      }
    ]
  },

  sessao_ana_rodrigues: {
    title: "Sess達o Ana Rodrigues",
    type: "photography",
    date: "2024-12-10",
    category: "Ensaios",
    items: [
      {
        type: "image",
        src: "https://i.postimg.cc/L8hcgtnJ/IMG-5564.jpg",
        thumbnail: "https://i.postimg.cc/L8hcgtnJ/IMG-5564.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/BQhWvYQW/DSC00467.jpg",
        thumbnail: "https://i.postimg.cc/BQhWvYQW/DSC00467.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/HndGrFym/IMG-5562.jpg",
        thumbnail: "https://i.postimg.cc/HndGrFym/IMG-5562.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/MKZ2q2wb/IMG-5563.jpg",
        thumbnail: "https://i.postimg.cc/MKZ2q2wb/IMG-5563.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/MKgDtV9M/DSC00645.jpg",
        thumbnail: "https://i.postimg.cc/MKgDtV9M/DSC00645.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/Z53LQnQf/IMG-5561.jpg",
        thumbnail: "https://i.postimg.cc/Z53LQnQf/IMG-5561.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/Jn7ctqzg/DSC00651.jpg",
        thumbnail: "https://i.postimg.cc/Jn7ctqzg/DSC00651.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/QM3qZsGj/DSC00690.jpg",
        thumbnail: "https://i.postimg.cc/QM3qZsGj/DSC00690.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/XJwS7nXx/DSC00653.jpg",
        thumbnail: "https://i.postimg.cc/XJwS7nXx/DSC00653.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/1zrr9Tsw/DSC00596.jpg",
        thumbnail: "https://i.postimg.cc/1zrr9Tsw/DSC00596.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/63HVZv7Q/DSC00714.jpg",
        thumbnail: "https://i.postimg.cc/63HVZv7Q/DSC00714.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/xCrV2Xjc/DSC00482.jpg",
        thumbnail: "https://i.postimg.cc/xCrV2Xjc/DSC00482.jpg"
      }
    ]
  },

  sessao_leonardo_monique: {
    title: "Sess達o Leonardo & Monique",
    type: "photography",
    date: "2024-11-20",
    category: "Ensaios",
    items: [
      {
        type: "image",
        src: "https://i.postimg.cc/CKZPMfGG/DSC-0088-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/CKZPMfGG/DSC-0088-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/VsXhbM34/DSC-0081-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/VsXhbM34/DSC-0081-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/K88pVW4s/DSC-0058-VSCO-Original.jpg",
        thumbnail: "https://i.postimg.cc/K88pVW4s/DSC-0058-VSCO-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/fTKg8sW9/DSC-0059-VSCO-Original.jpg",
        thumbnail: "https://i.postimg.cc/fTKg8sW9/DSC-0059-VSCO-Original.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/wBSW1T2S/DSC-0092-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/wBSW1T2S/DSC-0092-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/fLm8mngk/DSC-0097-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/fLm8mngk/DSC-0097-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/D0hBcjt6/DSC-0043-VSCO-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/D0hBcjt6/DSC-0043-VSCO-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/L4kysS1b/DSC-0104-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/L4kysS1b/DSC-0104-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/9QggjB7X/DSC-0017-VSCO-Original.jpg",
        thumbnail: "https://i.postimg.cc/9QggjB7X/DSC-0017-VSCO-Original.jpg"
      }
    ]
  },
  
  sessao_evandro_pamella: {
    title: "Sess達o Evandro & Pamella",
    type: "photography",
    date: "2024-10-15",
    category: "Ensaios",
    items: [
      {
        type: "image",
        src: "https://i.postimg.cc/mkGBy4Ln/DSC0019-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/mkGBy4Ln/DSC0019-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/4dpTd06Q/DSC0007-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/4dpTd06Q/DSC0007-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/sXW3WxrS/DSC0006-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/sXW3WxrS/DSC0006-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/Xq36ygxS/DSC0027-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/Xq36ygxS/DSC0027-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/kg59cfC7/Full-Size-Render-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/kg59cfC7/Full-Size-Render-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/BvkqtDd4/DSC0040-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/BvkqtDd4/DSC0040-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/rsCchHzw/DSC0046-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/rsCchHzw/DSC0046-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/ryS8FDg2/DSC0050-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/ryS8FDg2/DSC0050-VSCO.jpg"
      },
      {
        type: "image",
        src: "https://i.postimg.cc/3J1YmzPL/DSC0060-VSCO.jpg",
        thumbnail: "https://i.postimg.cc/3J1YmzPL/DSC0060-VSCO.jpg"
      }
    ]
  },

  filmagem_nicolas_lays: {
    title: "Filmagem Nicolas & Lays",
    type: "videography",
    date: "2024-12-15",
    category: "Ensaios",
    items: [
      {
        type: "youtube",
        src: "_2SUEnHmTNg",
        thumbnail: "https://i.postimg.cc/dQ8Tj714/DSC01249-Original.jpg"
      },
    ]
  },
  
  filmagem_anarodrigues: {
    title: "Filmagem Ana Rodrigues",
    type: "videography",
    date: "2024-12-05",
    category: "Ensaios",
    items: [
      {
        type: "youtube",
        src: "nQm9rewdjBs",
        thumbnail: "https://i.postimg.cc/cCmpwTRn/DSC00876.jpg"
      },
    ]
  },
};



// Utility Functions
function convertYouTubeUrl(videoId) {
  return `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;
}

function isYouTubeUrl(url) {
  return url.includes('youtube.com/watch?v=') || url.includes('youtu.be/');
}

function extractYouTubeId(url) {
  const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
  const match = url.match(regExp);
  return (match && match[2].length === 11) ? match[2] : null;
}

// Portfolio Class
class Portfolio {
  constructor() {
    this.currentProject = null;
    this.currentIndex = 0;
    this.currentFilter = 'all';
    this.currentSort = 'newest';
    this.portfolioItems = [];
    this.init();
  }

  init() {
    this.portfolioItems = Array.from(document.querySelectorAll('.portfolio-item'));
    this.bindEvents();
    this.setupFiltering();
    this.setupSorting();
    this.updateStats();
  }

  bindEvents() {
    // Portfolio links
   const portfolioItems = document.querySelectorAll('.portfolio-item');
    portfolioItems.forEach(item => {
      item.addEventListener('click', (e) => {
        e.preventDefault();
        const projectId = item.getAttribute('data-project');
        if (projectId) {
          this.openGallery(projectId);
        }
      });
    });

    // Modal controls
    const modal = document.getElementById('gallery-modal');
    const closeBtn = document.getElementById('close-modal');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    closeBtn.addEventListener('click', () => this.closeGallery());
    prevBtn.addEventListener('click', () => this.previousItem());
    nextBtn.addEventListener('click', () => this.nextItem());

    // Close modal when clicking outside
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        this.closeGallery();
      }
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (modal.classList.contains('active')) {
        switch(e.key) {
          case 'Escape':
            this.closeGallery();
            break;
          case 'ArrowLeft':
            this.previousItem();
            break;
          case 'ArrowRight':
            this.nextItem();
            break;
        }
      }
    });

    // Touch/Swipe functionality for mobile
    this.setupTouchNavigation();
  }

  setupTouchNavigation() {
    const galleryMain = document.getElementById('gallery-main');
    let touchStartX = 0;
    let touchEndX = 0;
    let touchStartY = 0;
    let touchEndY = 0;
    let isSwiping = false;
    let swipeIndicatorShown = false;

    // Touch events
    galleryMain.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
      touchStartY = e.changedTouches[0].screenY;
      isSwiping = false;
      
      // Hide swipe indicator after first touch
      if (!swipeIndicatorShown) {
        const indicator = document.querySelector('.swipe-indicator');
        if (indicator) {
          indicator.style.display = 'none';
          swipeIndicatorShown = true;
        }
      }
    }, { passive: false });

    galleryMain.addEventListener('touchmove', (e) => {
      if (!touchStartX) return;
      
      const currentX = e.changedTouches[0].screenX;
      const currentY = e.changedTouches[0].screenY;
      const diffX = Math.abs(currentX - touchStartX);
      const diffY = Math.abs(currentY - touchStartY);
      
      // Only handle horizontal swipes (not vertical scrolling)
      if (diffX > diffY && diffX > 20) {
        e.preventDefault();
        isSwiping = true;
        
        // Add visual feedback
        const img = galleryMain.querySelector('img');
        const iframe = galleryMain.querySelector('iframe');
        const activeElement = img || iframe;
        
        if (img) {
          galleryMain.classList.add('swiping');
          const direction = currentX > touchStartX ? 'right' : 'left';
          img.classList.remove('swipe-left', 'swipe-right');
          img.classList.add(`swipe-${direction}`);
        }
      }
    }, { passive: false });

    galleryMain.addEventListener('touchend', (e) => {
      if (!touchStartX) return;
      
      touchEndX = e.changedTouches[0].screenX;
      touchEndY = e.changedTouches[0].screenY;
      
      // Reset visual feedback
      const img = galleryMain.querySelector('img');
      if (img) {
        galleryMain.classList.remove('swiping');
        img.classList.remove('swipe-left', 'swipe-right');
      }
      
      // Only handle swipe if we were actually swiping
      if (isSwiping) {
        this.handleSwipe();
      }
      
      // Reset touch coordinates
      touchStartX = 0;
      touchEndX = 0;
      touchStartY = 0;
      touchEndY = 0;
      isSwiping = false;
    }, { passive: false });

    // Mouse events for desktop testing
    let mouseStartX = 0;
    let isMouseSwiping = false;

    galleryMain.addEventListener('mousedown', (e) => {
      mouseStartX = e.clientX;
      isMouseSwiping = true;
      e.preventDefault();
    });

    galleryMain.addEventListener('mousemove', (e) => {
      if (!isMouseSwiping) return;
      
      const currentX = e.clientX;
      const diffX = Math.abs(currentX - mouseStartX);
      
      if (diffX > 10) {
        const img = galleryMain.querySelector('img');
        if (img) {
          galleryMain.classList.add('swiping');
          const direction = currentX > mouseStartX ? 'right' : 'left';
          img.classList.remove('swipe-left', 'swipe-right');
          img.classList.add(`swipe-${direction}`);
        }
      }
    });

    galleryMain.addEventListener('mouseup', (e) => {
      if (!isMouseSwiping) return;
      
      const mouseEndX = e.clientX;
      const diffX = mouseEndX - mouseStartX;
      
      // Reset visual feedback
      const img = galleryMain.querySelector('img');
      if (img) {
        galleryMain.classList.remove('swiping');
        img.classList.remove('swipe-left', 'swipe-right');
      }
      
      // Handle swipe if significant movement
      if (Math.abs(diffX) > 50) {
        if (diffX > 0) {
          this.previousItem();
        } else {
          this.nextItem();
        }
      }
      
      isMouseSwiping = false;
      mouseStartX = 0;
    });

    // Prevent context menu on long press
    galleryMain.addEventListener('contextmenu', (e) => {
      e.preventDefault();
    });
  }

  handleSwipe() {
    const swipeThreshold = 80;
    const diffX = this.touchEndX - this.touchStartX;
    const diffY = Math.abs(this.touchEndY - this.touchStartY);
    
    // Only handle horizontal swipes
    if (Math.abs(diffX) > swipeThreshold && Math.abs(diffX) > diffY) {
      if (diffX > 0) {
        // Swipe right, show previous item
        this.previousItem();
      } else {
        // Swipe left, show next item
        this.nextItem();
      }
    }
  }

  setupFiltering() {
    const filterBtns = document.querySelectorAll('.filter-btn');

    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Show loading
        this.showLoading();
        
        // Update active button
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Filter items
        this.currentFilter = btn.getAttribute('data-filter');
        
        // Apply filter with delay for smooth animation
        setTimeout(() => {
          this.applyFilters();
          this.hideLoading();
        }, 300);
      });
    });
  }
  
  setupSorting() {
    const sortSelect = document.getElementById('sort-select');
    if (sortSelect) {
      sortSelect.addEventListener('change', (e) => {
        this.showLoading();
        this.currentSort = e.target.value;
        
        setTimeout(() => {
          this.applySorting();
          this.hideLoading();
        }, 300);
      });
    }
  }
  
  applyFilters() {
    let visibleCount = 0;
    
    this.portfolioItems.forEach(item => {
      const shouldShow = this.currentFilter === 'all' || item.classList.contains(this.currentFilter);
      
      item.classList.add('filtering');
      
      if (shouldShow) {
        item.classList.remove('hide');
        item.classList.add('show');
        item.style.display = 'block';
        visibleCount++;
      } else {
        item.classList.remove('show');
        item.classList.add('hide');
        setTimeout(() => {
          if (item.classList.contains('hide')) {
            item.style.display = 'none';
          }
        }, 400);
      }
    });
    
    // Update stats
    this.updateStats(visibleCount);
    
    // Show empty state if no items visible
    this.toggleEmptyState(visibleCount === 0);
    
    // Apply current sorting to visible items
    if (visibleCount > 0) {
      this.applySorting();
    }
  }
  
  applySorting() {
    const visibleItems = this.portfolioItems.filter(item => 
      !item.classList.contains('hide') && item.style.display !== 'none'
    );
    
    // Get project data for sorting
    const itemsWithData = visibleItems.map(item => {
      const projectId = item.getAttribute('data-project');
      const projectData = portfolioData[projectId];
      return {
        element: item,
        data: projectData,
        projectId
      };
    });
    
    // Sort based on current sort option
    itemsWithData.sort((a, b) => {
      switch (this.currentSort) {
        case 'newest':
          return new Date(b.data.date) - new Date(a.data.date);
        case 'oldest':
          return new Date(a.data.date) - new Date(b.data.date);
        case 'name-asc':
          return a.data.title.localeCompare(b.data.title);
        case 'name-desc':
          return b.data.title.localeCompare(a.data.title);
        case 'type':
          return a.data.type.localeCompare(b.data.type);
        default:
          return 0;
      }
    });
    
    // Reorder elements in DOM
    const portfolioGrid = document.querySelector('.portfolio-grid');
    itemsWithData.forEach((item, index) => {
      portfolioGrid.appendChild(item.element);
      // Add staggered animation delay
      item.element.style.animationDelay = `${index * 0.1}s`;
    });
  }
  
  updateStats(visibleCount = null) {
    const totalCount = this.portfolioItems.length;
    const visible = visibleCount !== null ? visibleCount : this.portfolioItems.filter(item => 
      !item.classList.contains('hide') && item.style.display !== 'none'
    ).length;
    
    const visibleCountEl = document.getElementById('visible-count');
    const totalCountEl = document.getElementById('total-count');
    
    if (visibleCountEl) visibleCountEl.textContent = visible;
    if (totalCountEl) totalCountEl.textContent = totalCount;
  }
  
  showLoading() {
    const loading = document.getElementById('portfolio-loading');
    const grid = document.querySelector('.portfolio-grid');
    const empty = document.getElementById('portfolio-empty');
    
    if (loading) loading.style.display = 'block';
    if (grid) grid.style.opacity = '0.5';
    if (empty) empty.style.display = 'none';
  }
  
  hideLoading() {
    const loading = document.getElementById('portfolio-loading');
    const grid = document.querySelector('.portfolio-grid');
    
    if (loading) loading.style.display = 'none';
    if (grid) grid.style.opacity = '1';
  }
  
  toggleEmptyState(show) {
    const empty = document.getElementById('portfolio-empty');
    const grid = document.querySelector('.portfolio-grid');
    
    if (empty) {
      empty.style.display = show ? 'block' : 'none';
    }
    if (grid) {
      grid.style.display = show ? 'none' : 'grid';
    }
  }

  openGallery(projectId) {
    const project = portfolioData[projectId];
    if (!project) return;

    this.currentProject = project;
    this.currentIndex = 0;

    // Update modal content
    document.getElementById('gallery-title').textContent = project.title;
    document.getElementById('total-items').textContent = project.items.length;

    // Generate thumbnails
    this.generateThumbnails();

    // Show first item
    this.showCurrentItem();

    // Show modal
    const modal = document.getElementById('gallery-modal');
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';

    // Update navigation buttons
    this.updateNavigation();
  }

  closeGallery() {
    const modal = document.getElementById('gallery-modal');
    modal.classList.remove('active');
    document.body.style.overflow = 'auto';

    // Clear iframe sources to stop videos
    const iframes = modal.querySelectorAll('iframe');
    iframes.forEach(iframe => {
      iframe.src = '';
    });

    this.currentProject = null;
    this.currentIndex = 0;
  }

  showCurrentItem() {
    if (!this.currentProject) return;

    const item = this.currentProject.items[this.currentIndex];
    const galleryMain = document.getElementById('gallery-main');
    
    // Update counter
    document.getElementById('current-index').textContent = this.currentIndex + 1;

    // Clear current content
    galleryMain.innerHTML = '';

    // Add new content based on type
    if (item.type === 'image') {
      const img = document.createElement('img');
      img.src = item.src;
      img.alt = this.currentProject.title;
      img.addEventListener('load', () => {
        img.style.opacity = '1';
      });
      img.style.opacity = '0';
      img.style.transition = 'opacity 0.3s ease';
      galleryMain.appendChild(img);
    } 
    else if (item.type === 'video') {
      const iframe = document.createElement('iframe');
      iframe.src = item.src;
      iframe.allow = 'autoplay; fullscreen; picture-in-picture';
      iframe.allowFullscreen = true;
      galleryMain.appendChild(iframe);
    }
    else if (item.type === 'youtube') {
      const iframe = document.createElement('iframe');
      iframe.src = convertYouTubeUrl(item.src);
      iframe.allow = 'autoplay; fullscreen; picture-in-picture';
      iframe.allowFullscreen = true;
      galleryMain.appendChild(iframe);
    }
    else if (item.type === 'external-link') {
      const linkContainer = document.createElement('div');
      linkContainer.className = 'external-link-container';
      linkContainer.innerHTML = `
        <div class="external-link-content">
          <i class="fas fa-external-link-alt"></i>
          <h3>${item.title || 'Ver Conte炭do Externo'}</h3>
          <p>Este conte炭do est叩 hospedado externamente</p>
          <a href="${item.src}" target="_blank" class="btn btn-primary">
            <i class="fas fa-arrow-right"></i> Abrir Link
          </a>
        </div>
      `;
      galleryMain.appendChild(linkContainer);
    }

    // Update thumbnail active state
    this.updateThumbnailActive();
    this.updateNavigation();
  }

  generateThumbnails() {
    const thumbnailsContainer = document.getElementById('gallery-thumbnails');
    thumbnailsContainer.innerHTML = '';

    this.currentProject.items.forEach((item, index) => {
      const thumbnail = document.createElement('div');
      thumbnail.className = `thumbnail ${item.type}`;
      if (index === 0) thumbnail.classList.add('active');

      const img = document.createElement('img');
      img.src = item.thumbnail;
      img.alt = `${this.currentProject.title} ${index + 1}`;
      
      thumbnail.appendChild(img);
      thumbnail.addEventListener('click', () => {
        this.currentIndex = index;
        this.showCurrentItem();
      });

      thumbnailsContainer.appendChild(thumbnail);
    });
  }

  updateThumbnailActive() {
    const thumbnails = document.querySelectorAll('.thumbnail');
    thumbnails.forEach((thumb, index) => {
      thumb.classList.toggle('active', index === this.currentIndex);
    });
  }

  previousItem() {
    if (!this.currentProject || this.currentIndex <= 0) return;
    this.currentIndex--;
    this.showCurrentItem();
  }

  nextItem() {
    if (!this.currentProject || this.currentIndex >= this.currentProject.items.length - 1) return;
    this.currentIndex++;
    this.showCurrentItem();
  }

  updateNavigation() {
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    if (!this.currentProject) return;

    prevBtn.disabled = this.currentIndex <= 0;
    nextBtn.disabled = this.currentIndex >= this.currentProject.items.length - 1;
  }
}

// Initialize Portfolio when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  new Portfolio();
});

window.addEventListener('DOMContentLoaded', () => {
    const indicator = document.querySelector('.swipe-indicator');
    setTimeout(() => {
      indicator.style.display = 'none';
    }, 5000); // 5 segundos
});